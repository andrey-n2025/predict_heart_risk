# predict_heart_risk

Учебный проект по созданию модели машинного обучения, которая на основе медицинских данных и информации о пациенте (возраст, пол и др.) прогнозирует вероятность сердечного приступа.


## Описание проекта

Проект охватывает весь процесс создания модели машинного обучения для задачи «да/нет» (будет ли риск сердечного приступа). 
Мы:
- изучаем данные;
- готовим их к обучению (исправляем пропуски, приводим числа к единому масштабу, отбираем важные признаки);
- обучаем модель с учётом того, что один класс встречается реже другого;
- запускаем готовую модель как веб сервис, куда можно загрузить CSV файл и получить ответы в формате «id, предсказание».

## Структура проекта

```
predict_heart_risk/
├── data/
│    └── heart_train.csv              # Обучающая выборка
│    └── heart_test.csv               # Тестовая выборка (без целевого признака)
├── models/
│   └── model_pipeline.pkl       # Сохранённый полный Pipeline (sklearn + joblib)
├── static/
│   └── style.css                
├── tests/
│   └── heart_test_predict.csv	 # Пример предсказаний на тестовой выборке
│   └── test.py                  # Скрипт для локальной оценки
├── templates/
│   └── index.html				 # простой шаблон страницы приложения
├── logs/                        # Логи сервиса (создаётся автоматически)
├── preprocessor.py              # Класс предобработки сырых данных
├── model.py                     # Обёртка над загруженной моделью
├── logging_file.py              # Настройка логирования
├── app2.py                      # FastAPI-приложение (веб-интерфейс + API)
├── Heart_Risk_research.ipynb    # Тетрадь Jupyter Notebook c исследованием данных и выбором модели с подобранными параметрами
├── Documentation.pdf            # Документация к проекту
└── README.md                    # Этот файл
```

## Технологический стек и изученные решения

В рамках проекта изучались и применялись следующие инструменты и практики:

- **Python 3** — основной язык разработки
- **pandas**, **numpy** — анализ и предобработка данных
- **scikit-learn** — построение Pipeline, обработка имбаланса, кросс-валидация, метрики (F1-score, classification_report)
- **joblib** — сериализация полного Pipeline для reproducibility
- **OOP** — создание классов (`Preprocessor`, `Model`)
- **Логирование** — централизованная настройка через `logging.config.dictConfig`, RotatingFileHandler
- **FastAPI** — создание REST API
- **Jinja2 + HTML/CSS** — простой веб-интерфейс для загрузки файлов и визуализации результатов
- **Uvicorn** — запуск ASGI-сервера
- фиксированный Pipeline, внешняя предобработка, детальное логирование удалённых строк

## Запуск сервиса

```bash
# Установка зависимостей (рекомендуется в virtualenv)
pip install -r requirements.txt

# Запуск
python app.py --port 8999
```

Сервис будет доступен по адресу http://localhost:8999

- Главная страница — веб-форма для загрузки CSV
- `/api/predict` — JSON API (streaming)
- `/health` — проверка работоспособности


## Рекомендации по улучшению

- Внедрить мониторинг признаков в продакшене
- Экспериментировать с ансамблями (XGBoost, LightGBM, CatBoost) для повышения F1-score на минорном классе
- Экмперементировать с Инжинирингом признаков
